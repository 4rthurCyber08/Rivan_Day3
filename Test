
#$34T#


Review
Jobs of a router:
1.
2.
3.
4.
5.

Static/Default Routing = Minimum Wage
OSPF/EIGRP = 30k-40k
BGP = 100k up
VPN = 30-40k

&nbsp;
---
&nbsp;

Routing - forwards data based on L3 information (IP Address)
- Linux: netstat -rn
- Windows: route print
- Cisco: show ip interface brief

&nbsp;
---
&nbsp;

Master Routing
Route Switch TShoot Hayup Lab

Login: root
Pass: C1sc0123

Devices
enable secret: pass

&nbsp;
---
&nbsp;


REVIEW on IP addressing

DHCP Loadbalancing

!@D1
conf t
 ip dhcp excluded-address 10.2.1.1 10.2.1.100
 ip dhcp pool MGMTPOOL.COM
  network 10.2.1.0 255.255.255.0
  default-router 10.2.1.254
  domain-name MGMTPOOL.COM
  dns-server 10.2.1.10
 !
 int e1/0
  switchport mode access
  switchport access vlan 100
  end

!@D2
conf t
 ip dhcp excluded-address 10.2.1.1 10.2.1.200
 ip dhcp pool MGMTPOOL.COM
  network 10.2.1.0 255.255.255.0
  default-router 10.2.1.254
  domain-name MGMTPOOL.COM
  dns-server 10.2.1.10
 !
 int e1/0
  switchport mode access
  switchport access vlan 20
  end


Exercise 03: Review - Place PCs (P1, P2) on VLAN 10

!@A1
conf t
 int e0/0
  switchport mode access
  switchport access vlan 10
  end

!@A2
conf t
 int e1/0
  switchport mode access
  switchport access vlan 10
  end

Make P1 & P2 a DHCP client:

!@P1
conf t
 int e0/0
  no shut
  ip add dhcp
  end

!@P2
conf t
 int e1/0
  no shut
  ip add dhcp
  end


What IP addresses did P1 & P2 get?

!@P1 & P2
show ip int brief | ex una



---



Static routing

Why routing?

From R1, 
ping 10.1.1.2  vs  ping 10.1.1.5

Is the result normal?


Configure Static routes to make them ping:

Recipe:
ip route [Destination IP]  [Network/Host Mask]  [Interface / Nex-hop]

Rules of Static Routing:
1. Ping Dikit, Route not Dikit

!@R1
conf t
 ip route 10.1.1.5 255.255.255.255 10.1.1.2
 end

Verify:

!@R1
ping 10.1.1.5



Exercise 01: Configure a static route on R2 destined for R3's e1/2 interface.

!@R2
conf t
 ip route __.__.__.__  __.__.__.__  __.__.__.__
 end

Ans

!@R2
conf t
 ip route 10.1.1.9 255.255.255.255 10.1.1.6
 end



2. Static Routing must be Two-way

!@R1
conf t
 ip route 10.1.1.6 255.255.255.255 10.1.1.2
 end
 
Routing must be two way

!@R3
conf t
 ip route 10.1.1.1 255.255.255.255 10.1.1.5
 end
 
 
 
---

Host Route vs Network Route

Configure a Network route on R3 destined for R1 & R2's connected network.

!@R3
show ip route static

Check the Network Mask of an interface: 3 ways
!@R1
show run
show int e1/0
show ip route 


!@R3
show ip route static
conf t
 ip route 10.1.1.0 255.255.255.252 10.1.1.5
 end
 

---

Make R1 ping R4

!@R1
conf t
 ip route 10.1.1.8 255.255.255.252 10.1.1.2
 end 

Verify:

!@R1
ping 10.1.1.9

vs

!@R1
ping 10.1.1.10


Exercise 02: Configure a network static route on R4 destined to R1's e1/0 interface

!@R4
conf t
 ip route 10.1.1.__ 255.255.255.252 10.1.1.__
 end


Ans

!@R4
conf t
 ip route 10.1.1.0 255.255.255.252 10.1.1.9
 end
 

3. The next-hop device must also know how to route the packet

Tip: R2 cannot reach R1; R4 cannot reach 

ans

!@R2
conf t
 ip route 10.1.1.8 255.255.255.252 10.1.1.6
 end
 
 
 
R4 & R1 can now ping, but that doesn't mean they can ping the network of R3 & R2.
 
!@R4
conf t
 ip route 10.1.1.4 255.255.255.252 10.1.1.9
 end





How devices forward Packets.

Source IP
Destination IP

Routing Table







---

Default Route

Floating static route

!@A1
conf t
 ip route 0.0.0.0 0.0.0.0 192.168.1.129 1
 ip route 0.0.0.0 0.0.0.0 192.168.1.130 10
 end


Verify:

!@A1
show ip route static
conf t
 no ip route 0.0.0.0 0.0.0.0 192.168.1.129 1
 end
show ip route static

Bring back the primary

!@A1
conf t
 ip route 0.0.0.0 0.0.0.0 192.168.1.129 1
 end
show ip route static




Exercise 03: Configure default routes on A2 with the following settings:
- D2 must be the primary gateway
- D1 must be the secondary gateway
- The AD must have a difference of 10

!@A2
conf t
 ip route 0.0.0.0 0.0.0.0 192.168.1.__  __
 ip route 0.0.0.0 0.0.0.0 192.168.1.__  __
 end

Ans

!@A2
conf t
 ip route 0.0.0.0 0.0.0.0 192.168.1.130  1
 ip route 0.0.0.0 0.0.0.0 192.168.1.129  10
 end



---

Static Routing: Path Selection - Longest Prefix Rule

!@P1
ping 10.2.1.1

vs

!@P1
ping 192.168.1.129
ping 192.168.1.130



Routing Policies, configure routing with the least hop count possible.

Path Selection Rules:
1. Longest Prefix

!@P1
conf t
 ip route 192.168.1.128 255.255.255.224 10.2.1.1
 end
 
Verify:

!@P1
traceroute 192.168.1.129
traceroute 192.168.1.130
traceroute 192.168.1.131
traceroute 192.168.1.132


Why does P1 need to take 2 hop counts to reach D2's VLAN 100?

Configure a host static route that takes advantage of the longest prefix rule to allow P1 to go directly to D2 instead of D1.

!@P1
conf t
 ip route 192.168.1.130 255.255.255.255 10.2.1.2
 end
 
Verify:

!@P1
show ip route static
 
Why longest prefix?

1 1 1 1  1 1 1 1    1 1 1 1  1 1 1 1    1 1 1 1  1 1 1 1    1 1 1 0  0 0 0 0 = /27
1 1 1 1  1 1 1 1    1 1 1 1  1 1 1 1    1 1 1 1  1 1 1 1    1 1 1 1  1 1 1 1 = /32


Verify:

!@P1
traceroute 192.168.1.129
traceroute 192.168.1.131
traceroute 192.168.1.132

vs

traceroute 192.168.1.130


---

Exercise 04: Configure static routes on P2, destine for VLAN 100 with the least hop counts possible to D1, D2, A1, and A2.

!@P2
conf t
 ip route 192.168.1.__  __.__.__.__  __.__.__.__
 ip route 192.168.1.__  __.__.__.__  __.__.__.__
 end

Ans

!@P2
conf t
 ip route 192.168.1.128 255.255.255.224 10.2.1.2
 ip route 192.168.1.129 255.255.255.255 10.2.1.1
 end


Exam Qustion

Which Route will P1 use to reach 192.168.1.130 ?


S*    0.0.0.0/0 [254/0] via 10.2.1.254
      10.0.0.0/8 is variably subnetted, 2 subnets, 2 masks

C        10.2.1.0/24 is directly connected, Ethernet0/0

L        10.2.1.101/32 is directly connected, Ethernet0/0
      192.168.1.0/24 is variably subnetted, 2 subnets, 2 masks

S        192.168.1.128/27 [1/0] via 10.2.1.1

S        192.168.1.130/32 [1/0] via 10.2.1.2


---


Excercise 05: Configure static routes to allow P1 to ping Google (8.8.8.8)




---

The need for Dynamc routing protocols

IGP - Interior Gateway Protocols
- Link-state = OSPF & ISIS
- Distance Vector = EIGRP & RIP

EGP - Exterior Gateway Protocols
- BGP = Border Gateway Protocol

---

EIGRP

Advertise Connected Routes

Step 1: Decide on an ASN
Step 2: Determine Connected Networks
Step 3: Advertise


!@R4
conf t
 router eigrp 100
  no auto-summary
  network 10.1.4.8 0.0.0.3
  network 10.1.4.4 0.0.0.3
  end
  
!@D1
config t
 router eigrp 100
  no auto-summary
  network 10.1.4.4 0.0.0.3
  network 10.2.1.0 0.0.0.255
  network 10.2.2.0 0.0.0.255
  network 192.168.1.128 0.0.0.31
end


Exercise 06 Configure EIGRP on D2. Advertise all connected routes.

!@D2
config t
 router ____  ____
  no auto-summary
  network __.__.__.__  __.__.__.__
  network __.__.__.__  __.__.__.__
  network __.__.__.__  __.__.__.__
  network __.__.__.__  __.__.__.__
  end


Ans

!@D2
conf t
 router eigrp 100
  no auto-summary
  network 10.1.4.8 0.0.0.3
  network 10.2.1.0 0.0.0.255
  network 10.2.2.0 0.0.0.255
  network 192.168.1.128 0.0.0.31
  end

---

OPTIONAL

Named EIGRP / Multi Address-Family EIGRP
When you are using NEXUS, address family is required.

!@R4
conf t
 router eigrp CCNPLEVEL
  address-family ipv4 unicast autonomous-system 100
   network 10.1.4.8 0.0.0.3
   network 10.1.4.4 0.0.0.3
   end
   
!@D1
conf t
 router eigrp CCNPLEVEL
  address-family ipv4 unicast autonomous-system 100
   network 10.1.4.4 0.0.0.3
   network 10.2.1.0 0.0.0.255
   network 10.2.2.0 0.0.0.255
   network 192.168.1.128 0.0.0.31
   end
  
!@D2
conf t
 router eigrp CCNPLEVEL
  address-family ipv4 unicast autonomous-system 100
   network 10.1.4.8 0.0.0.3
   network 10.2.1.0 0.0.0.255
   network 10.2.2.0 0.0.0.255
   network 192.168.1.128 0.0.0.31
   end

---

Data Structure
1. show ip eigrp neighbors : Neighbor Table
2. show ip eigrp interfaces : Interface Table
3. show ip eigrp topology : Topology Table

Verify:

show ip protocols
show ip eigrp neighbors
show ip eigrp interfaces
show ip eigrp topology
show ip route eigrp



Path Selection Rule 2: Administrative Distance

!@R4
show ip route

C Connected AD:
S Static AD:
D EIGRP AD: 
EIGRP Metric: 


What makes EIGRP a distance Vector protocol?

EIGRP Path Selection:
Reported Distance (RD) > Feasible Successor (Backup)
Feasible Distance (FD) >  Successor (Lowest Cost)

	Successor & Feasible successor (Backup)
	
	Feasability Condition
		An EIGRP route is a feasible successor route if the RD from the neighbor is less than the FD of the successor route.

FD/RD


Advantage of EIGRP
EIGRP Loadbalancing Unequal Cost Paths

Variance

!@R4
conf t
 router eigrp 100
  variance 2
  traffic-share balanced
  end
show ip eigrp traffic



Review

Path selection rules:

1. Longest Prefix

2. Administrative Distance

!@R4
show ip route
conf t
 ip route 10.2.1.0 255.255.255.0 10.1.4.6
 end
show ip route




---

What device do you need to filter data entering your network?
Firewall

Which is the best firewall?
Palo Alto
Fortinet
Juniper
Cisco Firepower

What Routing protocol to use if Multi-Vendor? OSPF

---

OSPF (Single Area OSPF)

Advertise Connected Routes

!@R3
conf t
 router ospf 1
  router-id 3.3.3.3
  network 3.3.3.3 0.0.0.0 area 0
  network 10.1.1.8 0.0.0.3 area 0
  network 10.1.1.4 0.0.0.3 area 0
  end

Exercise 06: Configure OSPF on R4 with the following settings:
- Process ID must be 1
- Advertise all connected routes that belong to OSPF area 0
- All of R4's interface belongs to Area 0
- Set R4's router id for OSPF as its loopback 4 IP

!@R4
conf t
 router ___  __
  router-id __.__.__.__
  network __.__.__.__  __.__.__.__ area __
  network __.__.__.__  __.__.__.__ area __
  end


Ans

!@R4
conf t
 router ospf 1
  router-id 4.4.4.4
  network 4.4.4.4 0.0.0.0 area 0
  network 10.1.1.8 0.0.0.3 area 0
  end


OSPF Interface-specific configuration.

!@R2
conf t
 router ospf 1
  router-id 2.2.2.2
  exit
 int lo2
  ip ospf 1 area 0
  exit
 int e1/1
  ip ospf 1 area 0
  exit
 int e1/2
  ip ospf 1 area 0
  end

!@R1
conf t
 router ospf 1
  router-id 1.1.1.1
  exit
 int lo1
  ip ospf 1 area 0
  exit
 int e1/0
  ip ospf 1 area 0
  end

---

---

Data Structure
1. show ip ospf neighbors : Neighbor Table
2. show ip ospf interface brief : Interface Table
3. show ip ospf topology-info : Topology Table

Verify:

show ip protocols
show ip ospf neighbors
show ip ospf interface brief
show ip ospf topology-info 
show ip route ospf



OSPF Network Types and Priorities.

Exercise 05: Ensure R3 is the DR for all its connected networks by completing the following tasks:
- Eliminate the need for a DR/BDR election between R4 & R3
- Configure R1 to be ineligible to become a DR/BDR
- Configure R2 with the highest priority on its e1/2 interface.

!@R4
conf t
 int e1/2
  ip ospf network point-to-point
  end


!@R3
conf t
 int e1/2
  ip ospf network point-to-point
  end
  

!@R2
conf t
 int e1/2
  ip ospf priority 255
  end
  

!@R1
conf t
 int e1/0
  ip ospf priority 0
  end


---

What Makes OSPF Link-state?

!@R4
conf t
 int lo4
  shut
  end

!@R1
show ip route ospf
show ip ospf route

Capture Hello Packets:

!@R4
conf t
 int e3/3
  no shut
  ip add 208.8.8.100 255.255.255.0
  ip ospf 1 area 0
  exit
 router eigrp 100
  network 208.8.8.0 0.0.0.255
  end


OSPF Hello Packet

- Router ID/Source OSPF Router
- Area ID
- Subnet Mask
- Authentication Type

- Hello Timer: 10
- Dead Timer: 40
- Designated Router
- Backup Designated Router

!@R3
show ip ospf traffic
show ip ospf database
show ip ospf database network

---

OSPF States

D - Down - The initial state where no hello packets have been received from a neighbor
I - Init - A hello packet has been received from a neighbor, but that neighbor's Router ID was not included in the hello packet, indicating a lack of bidirectional communication yet
T - Two-way - Bidirectional communication is established, as both routers have received each other's Router IDs in hello packets. DR/BDR Election occurs.
E - Exstart - Routers determine who will be the master and who will be the slave for the upcoming database exchange. The router with the higher Router ID becomes the master and begins the exchange of Database Description (DBD) packets, synchronizing sequence numbers. 
E - Exchange - Routers exchange DBD packets to describe their Link State Databases (LSDBs). They compare the contents and identify any missing link-state information
L - Loading - Routers request the missing link-state information by sending Link-State Requests (LSRs). They then receive Link-State Updates (LSUs) and acknowledge them with Link-State Acknowledgements (LSAs)
F - Full - he LSDBs are fully synchronized and identical between the adjacent routers. The routers have all the necessary information to form a complete network map and are ready to share routing data

Attempt to view OSPF States

!@R2 & R1
clear ip ospf process
yes
show ip ospf neighbor

---

Neighborship vs Adjacency
- Same Area
- Same Subnet Mask/Network
- Same Network Type
- Same Hello Interval
- Same Dead Interval


Practice Doing the wrong things
Mismatched Network Type

!@R3
conf t
 int e1/2
  no ip ospf network point-to-point
  end
show ip ospf neighbor
clear ip ospf process
yes

!@R4
show ip route ospf

---

!@R3 & R4
show ip ospf int e1/2

Determine the issue why R3 & R4 fail to form an adjacency:



Fix the adjacency:

!@R3
conf t
 int e1/2
  ip ospf network point-to-point
  end
show ip ospf neighbor
clear ip ospf process
yes
 



---

Mismatched Hello & Dead Timers

Remove the Adjacency of R2 & R1
!@R2
conf t
 int e1/2
  ip ospf hello-interval 20
  ip ospf dead-interval 60
  end
show ip ospf neighbor
clear ip ospf process

---

!@R2
show ip ospf int e1/2

!@R1
show ip ospf int e1/0


Determine the issue why R2 & R1 fail to form an adjacency:


Fix the adjacency:

!@R2
conf t
 int e1/2
  ip ospf hello-interval 10
  ip ospf dead-interval 40
  end
show ip ospf neighbor
clear ip ospf process



---

What makes OSPF Link-State? 
It builds a topology of the network.

LSU - Link-State Updates
  V
LSA - Link-State Advertisement

Type 1 LSA - (O) Router LSA
Type 2 LSA - (O IA) Network LSA
Type 3 LSA - Summary LSA


!@EDGE
conf t
 int lo0
  ip ospf 1 area #$34T#
  end
clear ip ospf process
yes


---

Optimize OSPF Network
Set loop back IPs Passive interface

!@R1
conf t
 router ospf 1
  passive-interface lo1
  end

!@R2
conf t
 router ospf 1
  passive-interface lo2
  end

!@R3
conf t
 router ospf 1
  passive-interface lo3
  end
 
!@R4
conf t
 router ospf 1
  passive-interface lo4
  end



---

OSPF & EIGRP Redistribution

!@R4
config T
 router eigrp 100
  redistribute ospf 1 metric 10000 100 255 1 1500
  exit
 router ospf 1
  redistribute eigrp 100 subnets
end


Review:

Path Selection Rule 1: 
Path Selection Rule 2:

!@R4, D1, R3
show ip route
show ip ospf | inc band

Administrative Distance

C Connected AD:
S Static AD:

D EIGRP AD: 
EIGRP Metric: 

D EX AD:

O OSPF AD:
OSPF Metric:


Interface Cost = Reference Bandwidth / Interface Bandwidth

!@R1,R2,R3,R4
conf t
 router ospf 1
  auto-cost reference-bandwidth 100000
  end


---


Route Summarization

!@R2
conf t
 int lo8
  ip add 10.10.8.1 255.255.255.0
  ip ospf 1 area 12
 int lo9
  ip add 10.10.9.1 255.255.255.0
  ip ospf 1 area 12
 int lo10
  ip add 10.10.10.1 255.255.255.0
  ip ospf 1 area 12
 int lo11
  ip add 10.10.11.1 255.255.255.0
  ip ospf 1 area 12
 int lo33
  ip add 10.10.33.1 255.255.255.128
  ip ospf 1 area 12
 int lo34
  ip add 10.10.33.129 255.255.255.128
  ip ospf 1 area 12
 int lo35
  ip add 10.10.34.1 255.255.255.128
  ip ospf 1 area 12
 int lo36
  ip add 10.10.34.129 255.255.255.128
  ip ospf 1 area 12
  exit
 router ospf 1
  passive-interface lo8
  passive-interface lo9
  passive-interface lo10
  passive-interface lo11
  passive-interface lo33
  passive-interface lo34
  passive-interface lo35
  passive-interface lo36
  end



Summarize

1. Determine the range between the first and last addresses to be summarized

.8.1
.9.1
.10.1
.11.1

2. Add the total range to a value closes to an i.

10.10.8.0/30


!@R2
conf t
 router ospf 1
  area 12 range 10.10.8.0 255.255.252.0
  end



Exercise 07: Summarize routes from loopback 33 - loopback 36

!@R2
conf t
 router ospf 1
  area 12 range 10.10.32.0 255.255.252.0 
  end


Remove All summarizations

!@R2
conf t
 router ospf 1
  no area 12 range 10.10.8.0 255.255.252.0
  no area 12 range 10.10.32.0 255.255.252.0
  end


Exercise 08: Summarize both summarized routes

!@R2
conf t
 router ospf 1
  area 12 range 10.10.0.0 255.255.0.0
  end
  


!@R4
show ip ospf database




---

Hurrican AS Number
- Globe
- PLDT
- Converge

BGP AS Numbers
R1 = ASN 1
I1 & I4(GOOGLE DNS) = ASN 45
I2 = ASN 2
I3 = ASN 1

!@R1
conf t
 router bgp 1
  bgp log-neighbor-changes
   neighbor 208.8.8.4 remote-as 45
   neighbor 207.7.7.2 remote-as 2
   neighbor 209.9.9.3 remote-as 3
   address-family ipv4
	neighbor 208.8.8.4 activate
    neighbor 207.7.7.2 activate
    neighbor 209.9.9.3 activate
    network 207.7.7.0 mask 255.255.255.0
    network 208.8.8.0 mask 255.255.255.0
    network 209.9.9.0 mask 255.255.255.0
    end

!@I1 - CONVERGE
conf t
 router bgp 45
  bgp log-neighbor-changes
  neighbor 24.2.4.2 remote-as 2
  neighbor 45.4.5.5 remote-as 45
  neighbor 208.8.8.1 remote-as 1
  address-family ipv4
   neighbor 24.2.4.2 activate
   neighbor 45.4.5.5 activate
   neighbor 208.8.8.1 activate
   network 208.8.8.0 mask 255.255.255.0
   network 24.2.4.0 mask 255.255.255.0
   network 44.44.44.44 mask 255.255.255.255
   network 45.4.5.0 mask 255.255.255.0
   end

!@I3 - GLOBE
conf t
 router bgp 3
  bgp log-neighbor-changes
  neighbor 32.3.2.2 remote-as 2
  neighbor 35.3.5.5 remote-as 45
  neighbor 209.9.9.1 remote-as 1
  address-family ipv4
   neighbor 32.3.2.2 activate
   neighbor 35.3.5.5 activate
   neighbor 209.9.9.1 activate
   network 209.9.9.0 mask 255.255.255.0
   network 32.3.2.0 mask 255.255.255.0
   network 33.33.33.33 mask 255.255.255.255
   network 35.3.5.0 mask 255.255.255.0
   end

!@I4 - GOOGLE
config t
 router bgp 45
  bgp log-neighbor-changes
  neighbor 25.2.5.2 remote-as 2
  neighbor 35.3.5.3 remote-as 3
  neighbor 45.4.5.4 remote-as 45
  address-family ipv4
   neighbor 25.2.5.2 activate
   neighbor 35.3.5.3 activate
   neighbor 45.4.5.4 activate
   network 8.8.8.8 mask 255.255.255.255
   network 55.55.55.55 mask 255.255.255.255
   network 25.2.5.0 mask 255.255.255.0
   network 35.3.5.0 mask 255.255.255.0
   network 45.4.5.0 mask 255.255.255.0
end


Exercise 06: Configure BGP on I2(PLDT). Set the ASN number to 2.
- Advertise the loopback IP

!@I2 - PLDT
config t
 router bgp __
 bgp log-neighbor-changes
 neighbor __.__.__.__ remote-as __
 neighbor __.__.__.__  remote-as __
 neighbor __.__.__.__  remote-as __
 neighbor __.__.__.__  remote-as __
 address-family __
  neighbor __.__.__.__  ____
  neighbor __.__.__.__  ____
  neighbor __.__.__.__  ____
  neighbor __.__.__.__  ____
  network __.__.__.__ mask __.__.__.__
  network __.__.__.__ mask __.__.__.__
  network __.__.__.__ mask __.__.__.__
  network __.__.__.__ mask __.__.__.__
  network __.__.__.__ mask __.__.__.__
  end

Ans

!@I2 - PLDT
config t
 router bgp 2
 bgp log-neighbor-changes
 neighbor 24.2.4.4 remote-as 45
 neighbor 25.2.5.5 remote-as 45
 neighbor 32.3.2.3 remote-as 3
 neighbor 207.7.7.1 remote-as 1
 address-family ipv4
  neighbor 24.2.4.4 activate
  neighbor 25.2.5.5 activate
  neighbor 32.3.2.3 activate
  neighbor 207.7.7.1 activate
  network 207.0.0.0 mask 255.255.255.0
  network 22.22.22.22 mask 255.255.255.255
  network 24.2.4.0 mask 255.255.255.0
  network 25.2.5.0 mask 255.255.255.0
  network 32.3.2.0 mask 255.255.255.0
  end


Verify:

show bgp summary


---

BGP - OSPF Redistribution

!@R1
conf t
 router ospf 1
  default-information originate always
  end


!@R1
show ip route


Administrative Distance

C Connected AD:
S Static AD:

D EIGRP AD: 
EIGRP Metric: 

D EX AD:

O OSPF AD:
OSPF Metric:

B BGP:
BGP Metric: Multi-Exit Discriminator Attributes



---

NAT

Step 1: Create an ACL to match traffic
Step 2: Define INSIDE and OUTSIDE

!@R1
conf t
 access-list 1 permit 10.0.0.0 0.255.255.255
 access-list 1 permit 172.16.0.0 0.15.255.255
 access-list 1 permit 192.168.0.0 0.0.255.255
 int range e1/1-3
  ip nat outside
  exit
 int e1/0
  ip nat inside
  end




Static NAT or 1:1

!@R1
conf t
 ip nat inside source static 10.1.4.6 209.9.9.1 
 end
show ip nat translations


!@R1
conf t
 ip nat inside source static __.__.__.__  __.__.__.__
 end
show ip nat translations


Ans

!@R1
conf t
 ip nat inside source static 10.1.4.10 207.7.7.1
 end
show ip nat translations


---


PAT

!@R1
conf t
 ip nat inside source list 1 interface ethernet 1/1 overload
 end




NAT Pool

!@R1
conf t
 ip nat pool CONVERGE 208.8.8.1 208.8.8.254 netmask 255.255.255.0
 ip nat inside source list 1 pool CONVERGE overload
 end

---

Route MAPS

!@R1
conf t
 access-list 10 permit 10.2.1.0 0.0.0.255
 access-list 20 permit 10.2.2.0 0.0.0.255
 access-list 30 permit 192.168.1.128 0.0.0.31
 
 ip nat pool CONVERGE 208.8.8.1 208.8.8.254 netmask 255.255.255.0
 ip nat pool PLDT 207.7.7.1 207.7.7.254 netmask 255.255.255.0
 ip nat pool GLOBE 209.9.9.1 209.9.9.254 netmask 255.255.255.0
 
 route-map RM_CONVERGE permit 10
  match ip address 10
  set ip nat pool CONVERGE
 route-map RM_PLDT permit 20
  match ip address 20
  set ip nat pool PLDT 
