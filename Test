
<!-- Your monitor number = #$34T# -->


Review
Jobs of a router:
1.
2.
3.
4.
5.

Static/Default Routing = Minimum Wage
OSPF/EIGRP = 30k-40k
BGP = 100k up
VPN = 30-40k

&nbsp;
---
&nbsp;

Routing - forwards data based on L3 information (IP Address)
- Linux: netstat -rn
- Windows: route print
- Cisco: show ip interface brief

&nbsp;
---
&nbsp;

Master Routing
Route Switch TShoot Hayup Lab

Login: root
Pass: C1sc0123

Devices
enable secret: pass

&nbsp;
---
&nbsp;


REVIEW on IP addressing & DHCP

Exercise 01: Steps to configure DHCP

1. Exclude IP addresses
2. Create DHCP pool
  - Network
  - Default-Router
  - Domain-Name
  - DNS-server

3. Assign DHCP clients






DHCP Loadbalancing

!@D1
conf t
 ip dhcp excluded-address 10.2.1.1 10.2.1.100
 ip dhcp pool MGMTPOOL.COM
  network 10.2.1.0 255.255.255.0
  default-router 10.2.1.254
  domain-name MGMTPOOL.COM
  dns-server 10.2.1.10
  end

!@D2
conf t
 ip dhcp excluded-address 10.2.1.1 10.2.1.200
 ip dhcp pool MGMTPOOL.COM
  network 10.2.1.0 255.255.255.0
  default-router 10.2.1.254
  domain-name MGMTPOOL.COM
  dns-server 10.2.1.10
  end



Review - Place PCs (P1, P2) on VLAN 10

!@A1
conf t
 int e0/0
  switchport mode access
  switchport access vlan 10
  end

!@A2
conf t
 int e1/0
  switchport mode access
  switchport access vlan 10
  end

Make P1 & P2 a DHCP client:

!@P1
conf t
 int e0/0
  no shut
  ip add dhcp
  end

!@P2
conf t
 int e1/0
  no shut
  ip add dhcp
  end


What IP addresses did P1 & P2 get?

!@P1 & P2
show ip int brief | ex una


---

Exercise 02: Configure S1 for VLAN 100, and manually set the IP address, 192.168.1.133 /27, on S1's e1/0 interface.
- Make sure S1 is able to ping D1, D2, A1, & A2 on VLAN 100.

!@S1
conf t



  end

!@D1
conf t



  end



Ans

!@S1
conf t
 int e1/0
  ip add 192.168.1.133 255.255.255.224
  no shut
  end

!@D1
conf t
 int e1/0
  switchport mode access
  switchport access vlan 100
  end


Exercise 03: Configure S2 for VLAN 20, and manually set the IP address, 10.2.2.133 /24, on S2's e1/0 interface.
- Make sure S2 is able to ping D1 & D2 on VLAN 20.

!@S2
conf t



  end

!@D2
conf t



  end
  
  
  
Ans

!@S2
conf t
 int e1/0
  ip add 10.2.2.133 255.255.255.0
  no shut
  end

!@D2
conf t
 int e1/0
  switchport mode access
  switchport access vlan 20
  end
  









# INTRO
# Static routing

Why routing?

From R1, 
ping 10.1.1.2  vs  ping 10.1.1.5

Is the result normal?



Configure Static routes to make them ping:

Syntax:
ip route [Destination IP]  [Network/Host Mask]  [Interface / Nex-hop]

What is a next-hop?

!@cmd
tracert 8.8.8.8

Tracing route to 8.8.8.8 over a maximum of 30 hops

  1     2 ms     1 ms     1 ms  192.168.1.1
  2     5 ms     6 ms     5 ms  100.83.0.1
  3     6 ms    11 ms     7 ms  122.2.203.6
  4    12 ms     6 ms     7 ms  210.213.130.15
  5    66 ms    62 ms    49 ms  142.250.175.196
  6     6 ms     6 ms     6 ms  142.251.251.47
  7     8 ms     5 ms     7 ms  142.250.58.243
  8     6 ms    10 ms    10 ms  8.8.8.8


Next-hop = 192.168.1.1



Rules of Static Routing:
  1. Ping Dikit, Route not Dikit

!@R1
conf t
 ip route 10.1.1.5 255.255.255.255 10.1.1.2
 end

Verify:

!@R1
ping 10.1.1.5



Exercise 04: Configure a static route on R2 destined for R3's e1/2 interface.

!@R2
conf t
 ip route __.__.__.__  __.__.__.__  __.__.__.__
 end

Ans

!@R2
conf t
 ip route 10.1.1.9 255.255.255.255 10.1.1.6
 end



Exercise 05: Configure a static route on R1 destined for R3's e1/1 interface.

!@R1
conf t
 ip route __.__.__.__  __.__.__.__  __.__.__.__
 end


Ans

!@R1
conf t
 ip route 10.1.1.6 255.255.255.255 10.1.1.2
 end
 
Routing must be two way

!@R3
conf t
 ip route 10.1.1.1 255.255.255.255 10.1.1.5
 end
  
  
  
  
---

Host Route vs Network Route

Exercise 06: Review. Find the network of the following IP addresses:
- 10.1.100.79 /18
- 172.16.145.18 /20
- 192.168.1.205 /30 

Ans

10.1.100.79 /18 (3rd, 64i)
= 10.1.64.0 /18

172.16.145.18 /20 (3rd, 16i)
= 172.16.144.0 /20

192.168.1.205 /30 (4th, 4i)
= 192.168.1.204 /30



Configure a Network route on R3 destined for R1 & R2's connected network.

!@R3
show ip route static


Check the Network Mask of an interface: 3 ways
!@R1
show run
show int e1/0
show ip route 


!@R3
show ip route static
conf t
 ip route 10.1.1.0 255.255.255.252 10.1.1.5
 end
show ip route static





---

Make R1 ping R4

!@R1
conf t
 ip route 10.1.1.8 255.255.255.252 10.1.1.2
 end 

Verify:

!@R1
ping 10.1.1.9

vs

!@R1
ping 10.1.1.10



Exercise 07: Configure a static network route on R4 destined to R1's e1/0 interface

!@R4
conf t
 ip route 10.1.1.__ 255.255.255.252 10.1.1.__
 end


Ans

!@R4
conf t
 ip route 10.1.1.0 255.255.255.252 10.1.1.9
 end
 
 
 


3. The next-hop device must also know how to route the packet

Tip: R2 cannot reach R1; R4 cannot reach 

ans

!@R2
conf t
 ip route 10.1.1.8 255.255.255.252 10.1.1.6
 end
 
 
 
R4 & R1 can now ping, but that doesn't mean they can ping the network of R3 & R2.
 
!@R4
conf t
 ip route 10.1.1.4 255.255.255.252 10.1.1.9
 end


How devices forward Packets.
Packet Forwarding Process:

Source IP, Destination IP

>

Source IP, Destination IP



Static route using interface instead of next-hop IP

Configure a static host route on R3, destined for R4's 10.1.4.9 IP using both a next-hop address and interface.

!@R3
conf t
 ip route 10.1.4.9 255.255.255.255 e1/2 10.1.1.10
 end







---

Default Route

!@cmd
route print


Floating static route

!@A1
conf t
 ip route 0.0.0.0 0.0.0.0 192.168.1.129 1
 ip route 0.0.0.0 0.0.0.0 192.168.1.130 10
 end


Verify:

!@A1
show ip route static
conf t
 no ip route 0.0.0.0 0.0.0.0 192.168.1.129 1
 end
show ip route static


Bring back the primary

!@A1
conf t
 ip route 0.0.0.0 0.0.0.0 192.168.1.129 1
 end
show ip route static




Exercise 08: Configure default routes on A2 with the following settings:
- D2 must be the primary gateway
- D1 must be the secondary gateway
- The AD must have a difference of 10

!@A2
conf t
 ip route 0.0.0.0 0.0.0.0 192.168.1.__  __
 ip route 0.0.0.0 0.0.0.0 192.168.1.__  __
 end

Ans

!@A2
conf t
 ip route 0.0.0.0 0.0.0.0 192.168.1.130  1
 ip route 0.0.0.0 0.0.0.0 192.168.1.129  10
 end



---

Path Selection Rules

1. Longest Prefix Rule
2. 
3. 


!@P1
ping 10.2.1.1

vs

!@P1
ping 192.168.1.129
ping 192.168.1.130



Routing Policies, configure routing with the least hop count possible.

!@P1
conf t
 ip route 192.168.1.128 255.255.255.224 10.2.1.1
 end
 
Verify:

!@P1
traceroute 192.168.1.129
traceroute 192.168.1.130
traceroute 192.168.1.131
traceroute 192.168.1.132


Why does P1 need to take 2 hop counts to reach D2's VLAN 100?

Configure a host static route that takes advantage of the longest prefix rule to allow P1 to go directly to D2 instead of D1.

!@P1
conf t
 ip route 192.168.1.130 255.255.255.255 10.2.1.2
 end
traceroute 192.168.1.130


Verify:

!@P1
show ip route static
 
Why longest prefix?

1 1 1 1  1 1 1 1    1 1 1 1  1 1 1 1    1 1 1 1  1 1 1 1    1 1 1 0  0 0 0 0 = /27
1 1 1 1  1 1 1 1    1 1 1 1  1 1 1 1    1 1 1 1  1 1 1 1    1 1 1 1  1 1 1 1 = /32


Verify:

!@P1
traceroute 192.168.1.129
traceroute 192.168.1.131
traceroute 192.168.1.132

vs

traceroute 192.168.1.130



Exam Question

Which Route will P1 use to reach 192.168.1.130 ?
S*    0.0.0.0/0 [254/0] via 10.2.1.254
      10.0.0.0/8 is variably subnetted, 2 subnets, 2 masks

C        10.2.1.0/24 is directly connected, Ethernet0/0

L        10.2.1.101/32 is directly connected, Ethernet0/0
      192.168.1.0/24 is variably subnetted, 2 subnets, 2 masks

S        192.168.1.128/27 [1/0] via 10.2.1.1

S        192.168.1.130/32 [1/0] via 10.2.1.2

---

Exercise 09: Configure static routes on P2, destine for VLAN 100 with the least hop counts possible to D1, D2, A1, and A2.

!@P2
conf t
 ip route 192.168.1.__  __.__.__.__  __.__.__.__
 ip route 192.168.1.__  __.__.__.__  __.__.__.__
 end

Ans

!@P2
conf t
 ip route 192.168.1.128 255.255.255.224 10.2.1.2
 ip route 192.168.1.129 255.255.255.255 10.2.1.1
 end





---


Excercise 10: Configure static routes to allow P1 to ping Google (8.8.8.8)




---

The need for Dynamc routing protocols

IGP - Interior Gateway Protocols
- Link-state = OSPF & ISIS
- Distance Vector = EIGRP & RIP

EGP - Exterior Gateway Protocols
- BGP = Border Gateway Protocol

---

!@D1,D2,R4
show version

If all Cisco, use EIGRP


EIGRP
Advertise Connected Routes

Step 1: Decide on an ASN
Step 2: Determine Connected Networks
Step 3: Advertise

!@R4
conf t
 router eigrp 100
  no auto-summary
  network 10.1.4.8 0.0.0.3
  network 10.1.4.4 0.0.0.3
  end
  
!@D1
config t
 router eigrp 100
  no auto-summary
  network 10.1.4.4 0.0.0.3
  network 10.2.1.0 0.0.0.255
  network 10.2.2.0 0.0.0.255
  network 192.168.1.128 0.0.0.31
end


Exercise 11: Configure EIGRP on D2. Advertise all connected routes.

!@D2
config t
 router ____  ____
  no auto-summary
  network __.__.__.__  __.__.__.__
  network __.__.__.__  __.__.__.__
  network __.__.__.__  __.__.__.__
  network __.__.__.__  __.__.__.__
  end


Ans

!@D2
conf t
 router eigrp 100
  no auto-summary
  network 10.1.4.8 0.0.0.3
  network 10.2.1.0 0.0.0.255
  network 10.2.2.0 0.0.0.255
  network 192.168.1.128 0.0.0.31
  end

---

OPTIONAL

Named EIGRP / Multi Address-Family EIGRP
When you are using NEXUS, address family is required.

!@R4
conf t
 router eigrp CCNPLEVEL
  address-family ipv4 unicast autonomous-system 100
   network 10.1.4.8 0.0.0.3
   network 10.1.4.4 0.0.0.3
   end
   
!@D1
conf t
 router eigrp CCNPLEVEL
  address-family ipv4 unicast autonomous-system 100
   network 10.1.4.4 0.0.0.3
   network 10.2.1.0 0.0.0.255
   network 10.2.2.0 0.0.0.255
   network 192.168.1.128 0.0.0.31
   end
  
!@D2
conf t
 router eigrp CCNPLEVEL
  address-family ipv4 unicast autonomous-system 100
   network 10.1.4.8 0.0.0.3
   network 10.2.1.0 0.0.0.255
   network 10.2.2.0 0.0.0.255
   network 192.168.1.128 0.0.0.31
   end

---

Data Structure
1. show ip eigrp neighbors : Neighbor Table
2. show ip eigrp interfaces : Interface Table
3. show ip eigrp topology : Topology Table

Verify:

show ip protocols
show ip eigrp neighbors
show ip eigrp interfaces
show ip eigrp topology
show ip route eigrp



Path Selection Rules

1. 
2. Administrative Distance
3. Metric Cost

!@R4
show ip route

C Connected AD:
S Static AD:
D EIGRP AD: 
EIGRP Metric: 


What makes EIGRP a distance Vector protocol?

!@R4
show ip eigrp topology
show ip eigrp protocols

EIGRP Path Selection:
Reported Distance (RD) > Feasible Successor (Backup)
Feasible Distance (FD) >  Successor (Lowest Cost)

	Successor & Feasible successor (Backup)
	
	Feasability Condition
		An EIGRP route is a feasible successor route if the RD from the neighbor is less than the FD of the successor route.

FD/RD


Advantage of EIGRP
EIGRP Loadbalancing Unequal Cost Paths

Variance

!@R4
conf t
 router eigrp 100
  variance 2
  traffic-share balanced
  end

or 

!@R4
conf t
 router eigrp CCNPLEVEL
  address-family ipv4 unicast autonomous-system 100
   topology base
    variance 2
    traffic-share balanced
    end


Review

Path selection rules:
1. Longest Prefix
2. Administrative Distance
3. Metric Cost


Exam Question: When the following command was entered on R4, why did the route to 10.2.1.0 changed from D - S

!@R4
terminal length 0
show ip route
!
conf t
 ip route 10.2.1.0 255.255.255.0 10.1.4.6
 end
show ip route






---

What device do you need to filter data entering your network?
Firewall

Which is the best firewall?
Palo Alto
Fortinet
Juniper
Cisco Firepower

What Routing protocol to use if Multi-Vendor? OSPF

---

OSPF (Single Area OSPF)

Advertise Connected Routes

!@R3
conf t
 router ospf 1
  router-id 3.3.3.3
  network 3.3.3.3 0.0.0.0 area 0
  network 10.1.1.8 0.0.0.3 area 0
  network 10.1.1.4 0.0.0.3 area 0
  end


Exercise 12: Configure OSPF on R4 with the following settings:
- Process ID must be 1
- Advertise all connected routes that belong to OSPF area 0
- All of R4's interface belongs to Area 0
- Set R4's router id for OSPF as its loopback 4 IP

!@R4
conf t
 router ___  __
  router-id __.__.__.__
  network __.__.__.__  __.__.__.__ area __
  network __.__.__.__  __.__.__.__ area __
  end


Ans

!@R4
conf t
 router ospf 1
  router-id 4.4.4.4
  network 4.4.4.4 0.0.0.0 area 0
  network 10.1.1.8 0.0.0.3 area 0
  end


OSPF Interface-specific network advertisement.

!@R2
conf t
 router ospf 1
  router-id 2.2.2.2
  exit
 int lo2
  ip ospf 1 area 0
  exit
 int e1/1
  ip ospf 1 area 0
  exit
 int e1/2
  ip ospf 1 area 0
  end

!@R1
conf t
 router ospf 1
  router-id 1.1.1.1
  exit
 int lo1
  ip ospf 1 area 0
  exit
 int e1/0
  ip ospf 1 area 0
  end

---

Data Structure
1. show ip ospf neighbors : Neighbor Table
2. show ip ospf interface brief : Interface Table
3. show ip ospf topology-info : Topology Table

Verify:

show ip protocols
show ip ospf neighbors
show ip ospf interface brief
show ip ospf topology-info 
show ip route ospf



OSPF Network Types and Priorities.

Exercise 13: Ensure R3 is the DR for all its connected networks by completing the following tasks:
- Eliminate the need for a DR/BDR election between R4 & R3
- Configure R1 to be ineligible to become a DR/BDR
- Configure R2 with the highest priority on its e1/2 interface.

!@R4
conf t
 int e1/2
  ip ospf network point-to-point
  end


!@R3
conf t
 int e1/2
  ip ospf network point-to-point
  end
  

!@R2
conf t
 int e1/2
  ip ospf priority 255
  end
  

!@R1
conf t
 int e1/0
  ip ospf priority 0
  end


Verify:

!@R4,R3,R2,R1
show ip ospf neighbor

---

What makes a dynamic routing protocol?

!@R4
conf t
 int lo4
  shut
  end

!@R1
show ip route ospf
show ip ospf route


Bring back Loopback 4.4.4.4

!@R4
conf t
 int lo4
  no shut
  end


--

Capture Hello Packets:

!@R4
conf t
 int e3/3
  no shut
  ip add 208.8.8.100 255.255.255.0
  ip ospf 1 area 0
  exit
 router eigrp 100
  network 208.8.8.0 0.0.0.255
  end


Contents of an OSPF Hello Packet
- Router ID/Source OSPF Router
- Area ID
- Subnet Mask
- Authentication Type

- Hello Timer: 10
- Dead Timer: 40
- Designated Router
- Backup Designated Router

---

What makes OSPF Link-State?
 
It builds a topology of the network.

LSU - Link-State Updates
  V
LSA - Link-State Advertisement

Type 1 LSA - (O) Router LSA : Router info
Type 2 LSA - (O) Network LSA : via DR/BDR Network Routes
Type 3 LSA - (O IA) Summary LSA
Type 5 LSA - (O E2) AS-External LSA


!@EDGE
conf t
 int lo#$34T#
  int #$34T#.#$34T#.#$34T#.#$34T# 255.255.255.255
  ip ospf 1 area #$34T#
  end
clear ip ospf process
yes

!@R3
show ip ospf database
show ip ospf database network


---

OSPF States

D - Down - The initial state where no hello packets have been received from a neighbor
I - Init - A hello packet has been received from a neighbor, but that neighbor's Router ID was not included in the hello packet, indicating a lack of bidirectional communication yet
T - Two-way - Bidirectional communication is established, as both routers have received each other's Router IDs in hello packets. DR/BDR Election occurs.
E - Exstart - Routers determine who will be the master and who will be the slave for the upcoming database exchange. The router with the higher Router ID becomes the master and begins the exchange of Database Description (DBD) packets, synchronizing sequence numbers. 
E - Exchange - Routers exchange DBD packets to describe their Link State Databases (LSDBs). They compare the contents and identify any missing link-state information
L - Loading - Routers request the missing link-state information by sending Link-State Requests (LSRs). They then receive Link-State Updates (LSUs) and acknowledge them with Link-State Acknowledgements (LSAs)
F - Full - the LSDBs are fully synchronized and identical between the adjacent routers. The routers have all the necessary information to form a complete network map and are ready to share routing data

Attempt to view OSPF States

!@R2 & R1
clear ip ospf process
yes
show ip ospf neighbor

---

Neighborship vs Adjacency
- Same Area
- Same Subnet Mask/Network
- Same Network Type
- Same Hello Interval
- Same Dead Interval


Practice Doing the wrong things
Mismatched Network Type

!@R3
conf t
 int e1/2
  no ip ospf network point-to-point
  end
show ip ospf neighbor
clear ip ospf process
yes

!@R4
show ip route ospf

---

!@R3 & R4
show ip ospf int e1/2

Determine the issue why R3 & R4 fail to form an adjacency:



Fix the adjacency:

!@R3
conf t
 int e1/2
  ip ospf network point-to-point
  end
show ip ospf neighbor
clear ip ospf process
yes
 



---

Mismatched Hello & Dead Timers

Remove the Adjacency of R2 & R1
!@R2
conf t
 int e1/2
  ip ospf hello-interval 20
  ip ospf dead-interval 60
  end
show ip ospf neighbor
clear ip ospf process
yes


---

!@R2
show ip ospf int e1/2

!@R1
show ip ospf int e1/0


Determine the issue why R2 & R1 fail to form an adjacency:


Fix the adjacency:

!@R2
conf t
 int e1/2
  ip ospf hello-interval 10
  ip ospf dead-interval 40
  end
show ip ospf neighbor
clear ip ospf process


---

Optimize OSPF Network
Set loop back IPs Passive interface

!@R1
conf t
 router ospf 1
  passive-interface lo1
  end

!@R2
conf t
 router ospf 1
  passive-interface lo2
  end

!@R3
conf t
 router ospf 1
  passive-interface lo3
  end
 
!@R4
conf t
 router ospf 1
  passive-interface lo4
  end



---

OSPF & EIGRP Redistribution

!@R4
config T
 router eigrp 100
  redistribute ospf 1 metric 10000 100 255 1 1500
  exit
 router ospf 1
  redistribute eigrp 100 subnets
end


Review:

Path Selection Rule 1: 
Path Selection Rule 2:
Path Selection Rule 3:

!@R4, D1, R3
show ip route
show ip ospf | inc band

Administrative Distance

C Connected AD:
S Static AD:

D EIGRP AD: 
EIGRP Metric: 

D EX AD:

O OSPF AD: 
OSPF Metric: 


Interface Cost = Reference Bandwidth / Interface Bandwidth

!@R1,R2,R3,R4
conf t
 router ospf 1
  auto-cost reference-bandwidth 100000
  end


---
OPTIONAL - REDISTRIBUTION via Named EIGRP

Named EIGRP / Multi Address-Family EIGRP
When you are using NEXUS, address family is required.

!@R4
conf t
 router eigrp CCNPLEVEL
  address-family ipv4 unicast autonomous-system 100
   topology base
    redistribute ospf 1 metric 10000 100 255 1 1500
	exit
   exit
  exit
 router ospf 1
  redistribute eigrp 100 subnets
    end
   
---


Route Summarization

!@R2
conf t
 int lo8
  ip add 10.10.8.1 255.255.255.0
  ip ospf 1 area 12
 int lo9
  ip add 10.10.9.1 255.255.255.0
  ip ospf 1 area 12
 int lo10
  ip add 10.10.10.1 255.255.255.0
  ip ospf 1 area 12
 int lo11
  ip add 10.10.11.1 255.255.255.0
  ip ospf 1 area 12
 int lo33
  ip add 10.10.33.1 255.255.255.128
  ip ospf 1 area 12
 int lo34
  ip add 10.10.33.129 255.255.255.128
  ip ospf 1 area 12
 int lo35
  ip add 10.10.34.1 255.255.255.128
  ip ospf 1 area 12
 int lo36
  ip add 10.10.34.129 255.255.255.128
  ip ospf 1 area 12
  exit
 router ospf 1
  passive-interface lo8
  passive-interface lo9
  passive-interface lo10
  passive-interface lo11
  passive-interface lo33
  passive-interface lo34
  passive-interface lo35
  passive-interface lo36
  end



Summarize

1. Determine the range between the first and last addresses to be summarized

.8.1
.9.1
.10.1
.11.1

8 - 11 = 3 

2. From the total range determine the next closes i.

The closest to 3 is 4i

10.10.8.0/30


!@R2
conf t
 router ospf 1
  area 12 range 10.10.8.0 255.255.252.0
  end



Exercise 14: Summarize routes from loopback 33 - loopback 36

!@R2
conf t
 router ospf 1
  area 12 range 10.10.32.0 255.255.252.0 
  end


Remove All summarizations

!@R2
conf t
 router ospf 1
  no area 12 range 10.10.8.0 255.255.252.0
  no area 12 range 10.10.32.0 255.255.252.0
  end


Exercise 15: Summarize both summarized routes

.8
.9
.10
.11
.33
.34
.35
.36

!@R2
conf t
 router ospf 1
  area 12 range 10.10.0.0 255.255.192.0
  end

!@R4
show ip ospf database






---

Hurrican AS Number
- Globe
- PLDT
- Converge


BGP ASn Numbers
R1 = ASN 1
I1 & I4(GOOGLE DNS) = ASN 45
I2 = ASN 2
I3 = ASN 1



!@R1
conf t
 router bgp 1
  bgp log-neighbor-changes
   neighbor 208.8.8.4 remote-as 45
   neighbor 207.7.7.2 remote-as 2
   neighbor 209.9.9.3 remote-as 3
   address-family ipv4
	neighbor 208.8.8.4 activate
    neighbor 207.7.7.2 activate
    neighbor 209.9.9.3 activate
    network 207.7.7.0 mask 255.255.255.0
    network 208.8.8.0 mask 255.255.255.0
    network 209.9.9.0 mask 255.255.255.0
    end

!@I1 - CONVERGE
conf t
 router bgp 45
  bgp log-neighbor-changes
  neighbor 24.2.4.2 remote-as 2
  neighbor 45.4.5.5 remote-as 45
  neighbor 208.8.8.1 remote-as 1
  address-family ipv4
   neighbor 24.2.4.2 activate
   neighbor 45.4.5.5 activate
   neighbor 208.8.8.1 activate
   network 208.8.8.0 mask 255.255.255.0
   network 24.2.4.0 mask 255.255.255.0
   network 44.44.44.44 mask 255.255.255.255
   network 45.4.5.0 mask 255.255.255.0
   end


Exercise 16: Configure BGP on I3 - Globe with the following:
- Advertise all connected networks
- Set the ASN number to ASN 3

!@I3 - GLOBE
conf t
 router bgp __
  bgp log-neighbor-changes
  ______  __.__.__.__ remote-as __
  ______  __.__.__.__ remote-as __
  ______  __.__.__.__ remote-as __
  address-family __
   ______  __.__.__.__ activate
   ______  __.__.__.__ activate
   ______  __.__.__.__ activate
   ______  __.__.__.__ mask __.__.__.__
   ______  __.__.__.__ mask __.__.__.__
   ______  __.__.__.__ mask __.__.__.__
   ______  __.__.__.__ mask __.__.__.__
   end
   

Ans

!@I3 - GLOBE
conf t
 router bgp 3
  bgp log-neighbor-changes
  neighbor 32.3.2.2 remote-as 2
  neighbor 35.3.5.5 remote-as 45
  neighbor 209.9.9.1 remote-as 1
  address-family ipv4
   neighbor 32.3.2.2 activate
   neighbor 35.3.5.5 activate
   neighbor 209.9.9.1 activate
   network 209.9.9.0 mask 255.255.255.0
   network 32.3.2.0 mask 255.255.255.0
   network 33.33.33.33 mask 255.255.255.255
   network 35.3.5.0 mask 255.255.255.0
   end




!@I4 - GOOGLE
config t
 router bgp 45
  bgp log-neighbor-changes
  neighbor 25.2.5.2 remote-as 2
  neighbor 35.3.5.3 remote-as 3
  neighbor 45.4.5.4 remote-as 45
  address-family ipv4
   neighbor 25.2.5.2 activate
   neighbor 35.3.5.3 activate
   neighbor 45.4.5.4 activate
   network 8.8.8.8 mask 255.255.255.255
   network 55.55.55.55 mask 255.255.255.255
   network 25.2.5.0 mask 255.255.255.0
   network 35.3.5.0 mask 255.255.255.0
   network 45.4.5.0 mask 255.255.255.0
end


Exercise 17: Configure BGP on I2(PLDT). Set the ASN number to 2.
- Advertise the loopback IP

!@I2 - PLDT
config t
 router bgp __
 bgp log-neighbor-changes
 neighbor __.__.__.__ remote-as __
 neighbor __.__.__.__  remote-as __
 neighbor __.__.__.__  remote-as __
 neighbor __.__.__.__  remote-as __
 address-family __
  neighbor __.__.__.__  ____
  neighbor __.__.__.__  ____
  neighbor __.__.__.__  ____
  neighbor __.__.__.__  ____
  network __.__.__.__ mask __.__.__.__
  network __.__.__.__ mask __.__.__.__
  network __.__.__.__ mask __.__.__.__
  network __.__.__.__ mask __.__.__.__
  network __.__.__.__ mask __.__.__.__
  end

Ans

!@I2 - PLDT
config t
 router bgp 2
 bgp log-neighbor-changes
 neighbor 24.2.4.4 remote-as 45
 neighbor 25.2.5.5 remote-as 45
 neighbor 32.3.2.3 remote-as 3
 neighbor 207.7.7.1 remote-as 1
 address-family ipv4
  neighbor 24.2.4.4 activate
  neighbor 25.2.5.5 activate
  neighbor 32.3.2.3 activate
  neighbor 207.7.7.1 activate
  network 207.0.0.0 mask 255.255.255.0
  network 22.22.22.22 mask 255.255.255.255
  network 24.2.4.0 mask 255.255.255.0
  network 25.2.5.0 mask 255.255.255.0
  network 32.3.2.0 mask 255.255.255.0
  end


Verify:

show bgp summary


---

BGP - OSPF Redistribution (Default Route Propagation)

!@R1
conf t
 router ospf 1
  default-information originate always
  end


!@R1
show ip route


Administrative Distance

C Connected AD:
S Static AD:

D EIGRP AD: 
EIGRP Metric: 

D EX AD:

O OSPF AD:
OSPF Metric:

B BGP Internal AD:
B BGP External AD:
BGP Metric: Multi-Exit Discriminator Attributes


!@R1
show ip route





---

NAT

INSIDE GLOBAL     INSIDE LOCAL         OUTSIDE LOCAL      OUTSIDE GLOBAL



Step 1: Define INSIDE and OUTSIDE

!@R1
conf t
 int range e1/1-3
  ip nat outside
  exit
 int e1/0
  ip nat inside
  end
  
Step 2: Create an ACL to match traffic

!@R1
conf t
 access-list 1 permit 10.0.0.0 0.255.255.255
 access-list 1 permit 172.16.0.0 0.15.255.255
 access-list 1 permit 192.168.0.0 0.0.255.255
 end

Step 3: Configure desired NAT

Static NAT or 1:1

!@R1
conf t
 ip nat inside source static 10.1.4.6 209.9.9.1 
 ip nat inside source static 10.1.1.2 209.9.9.2
 ip nat inside source static 10.1.1.10 209.9.9.3
 end
show ip nat translations

10.1.4.6 = D1
10.1.1.2 = R2
10.1.1.10 = R4

!@D1, R2, R4
ping 8.8.8.8


Can all of them ping 8.8.8.8? If not, explain why.

Fix


!@R1
clear ip nat translation *
conf t
 no ip nat inside source static 10.1.1.10 209.9.9.3
 ip nat inside source static 10.1.1.10 209.9.9.4
 end
show ip nat translations


Exercise 18: Configure Static NAT to output the following:

Pro  INSIDE GLOBAL    INSIDE LOCAL 
---  207.7.7.1        192.168.1.131
icmp 207.7.7.1:x      192.168.1.131:x
---  208.8.8.45       10.1.4.10
icmp 208.8.8.45:x     10.1.4.10:x
---  209.9.9.99       3.3.3.3
icmp 209.9.9.99:x     3.3.3.3:x

Tip:

192.168.1.131 = A1
10.1.4.10 = D2
3.3.3.3 = R3

!@R1
conf t
 ip nat inside source static 192.168.1.131 207.7.7.1
 ip nat inside source static 10.1.4.10 208.8.8.45
 ip nat inside source static 3.3.3.3 209.9.9.99
 end 


Verify with a ping to 8.8.8.8 on the 3 devices, 
then use the show command to reveal translated IPs on R1.



!@R1
conf t
 ip nat inside source static 192.168.1.131 207.7.7.1
 ip nat inside source static 10.1.4.10 208.8.8.45
 ip nat inside source static 3.3.3.3 209.9.9.99
 end 
show ip nat translations


Ans

!@R1
conf t
 ip nat inside source static 10.1.4.10 207.7.7.1
 end
show ip nat translations


---

Dynamic NAT or 1:Many

Create a pool of addresses

!@R1
conf t
 ip nat pool mynatpool 209.9.9.4 209.9.9.254 netmask 255.255.255.0
 ip nat inside source list 1 pool mynatpool
 end


Verify:

!@A2
ping 8.8.8.8



Exercise 19: Determine why D1 failed to ping 8.8.8.8 with a source IP of 10.2.1.1

!@D1
ping 8.8.8.8 source 10.2.1.1

Ans

R1 does not have a route for 10.2.1.0/24 network

SOLUTION
Either remove the static route from R4 to 10.2.1.0/24 network to prevent R4 from discarding the route learned via EIGRP

!@R4
conf t
 no ip route 10.2.1.0 255.255.255.0 10.1.4.6
 end
 
or

Redistribute static routes into OSPF

!@R4
conf t
 router ospf 1
  redistribute static subnets
  end




---

NAT Overloading or PAT

- Translate private ips to a single ip  using a unique port number.

!@R1
clear ip nat translation *
conf t
 no ip nat inside source list 1 pool mynatpool
 end


!@R1
conf t
 ip nat inside source list 1 interface e1/1 overload
 end



Exercise 20: Configure P1, P2, S1, & S2 to successfully ping 8.8.8.8

They do not have default routes

!@P1,P2
conf t
 ip route 0.0.0.0 0.0.0.0 10.2.1.1
 end


!@S1
conf t
 ip route 0.0.0.0 0.0.0.0 192.168.1.129
 end

!@S2
conf t
 ip route 0.0.0.0 0.0.0.0 10.2.2.2
 end

Why are end devices configured with default routes.






-----

IPv6

Does your device support IPv6?


What is a valid IPv6 address?


IPv6 compression rules

1. All zeroes on the left are ommitted.

:00a0:  >   :a0:

2. Subsequent zeroes turn into double colon.

:0000:0000:0000:00a0:  >  ::a0:

3. When there are two subsequent zeroes, the one with more zeroes gets turned into :
while the other zeroes becom :0:

:0000:0000:00a0:0000:0000:0000:  >  :0:0:a0::

4. When subsequent zeroes match on both sides, the one on the left turns into double colon.

:0000:0000:00a0:0000:0000:  >  ::a0:0:0:


Exercise 21: Compress IPv6 address

1. 000a:000c:0000:0000:0000:0000:0000:0000/64 =
	
2. 0000:0000:0000:0000:0000:0000:0000:0000/0 = 
			
3. fe80:0000:0000:0000:000a:0000:0000:000f/64 =
	
4. 2002:6500:0000:3000:0000:0000:0000:0000/64 = 
	
5. 0000:0000:0000:0000:0000:0000:0000:0001/128 = 
	
6. ff00:0000:0000:beef:a00a:0aa0:0000:0000/8 = 


---


IPv6 subnetting


8  4  2   1    8  4  2   1     8  4  2   1    8  4  2   1 


IPV6 SUBNETTING (HOSTS):
fec0:aabb:fafa:dada::/64 subnet for 48 users:
Convert:
S:
Ipasok:



IPV6 SUBNETTING (SUBNETS):
fec0:aabb:fafa:dada::/64 subnet to 22 offices/subnets:
Convert:  22 -> 5bits
Add: /64 + /5 = /69
Ipasok:







---


IPv6 Static & Default Routing



IPv6 Transition Technology



IPv6 autoconfig























---

IP SLA


conf t 
 ip sla 1
  icmp-echo 8.8.8.8
  frequency 10
 ip sla schedule 1 life forever start-time now
 end

TRACK

conf t
 track 1 ip sla 1 reachability 
 track 1 ip sla 1 state
  delay up 5
  delay down 10
 end

ROUTE-MAP

conf t
 route-map NAT-FAILOVER-PLDT permit 10
  match ip address 1
  set int e1/2
 route-map NAT-FAILOVER-GLOBE permit 20
  match ip address 1
  set int e1/3
  end
  
 route-map NAT-FAILOVER permit 10
  match track 1
  set int e1.2
  

  
















Route MAPS

!@R1
conf t
 access-list 10 permit 10.2.1.0 0.0.0.255
 access-list 20 permit 10.2.2.0 0.0.0.255
 access-list 30 permit 192.168.1.128 0.0.0.31
 
 ip nat pool CONVERGE 208.8.8.1 208.8.8.254 netmask 255.255.255.0
 ip nat pool PLDT 207.7.7.1 207.7.7.254 netmask 255.255.255.0
 ip nat pool GLOBE 209.9.9.1 209.9.9.254 netmask 255.255.255.0
 
 route-map RM_CONVERGE permit 10
  match ip address 10
  set ip nat pool CONVERGE
 route-map RM_PLDT permit 20
  match ip address 20
  set ip nat pool PLDT 
